<div class="container mt-4">
  <!-- Кнопка назад -->
  <button class="btn btn-outline-secondary mb-3" (click)="goBack()">
    <i class="bi bi-arrow-left"></i> Back to Devices
  </button>

  <!-- Заголовок -->
  <h3 class="mb-3">Device Sessions: <span class="text-primary">{{ deviceId }}</span></h3>
  
  <!-- Информация об устройстве -->
  <div *ngIf="deviceInfo" class="card mb-4">
    <div class="card-body">
      <h5 class="card-title">Device Information</h5>
      <div class="row">
        <div class="col-md-6">
          <p class="mb-1"><strong>User:</strong> {{ deviceInfo.userName || deviceInfo.username }}</p>
          <p class="mb-1"><strong>Latest Version:</strong> 
            <span class="badge bg-success">{{ deviceInfo.latestVersion || deviceInfo.latestversion }}</span>
          </p>
        </div>
        <div class="col-md-6">
          <p class="mb-1"><strong>Total Sessions:</strong> 
            <span class="badge bg-info">{{ sessions.length }}</span>
          </p>
          <p class="mb-1"><strong>Last Activity:</strong> 
            {{ formatDate(deviceInfo.lastActivity || deviceInfo.lastactivity) }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Загрузка -->
  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading sessions...</p>
  </div>

  <!-- Ошибка -->
  <div *ngIf="error && !loading" class="alert alert-warning">
    <i class="bi bi-exclamation-triangle"></i> {{ error }}
  </div>

  <!-- Нет данных -->
  <div *ngIf="!loading && sessions.length === 0 && !error" class="alert alert-info">
    <i class="bi bi-info-circle"></i> No sessions found for this device.
  </div>

  <!-- Таблица сессий -->
  <div *ngIf="!loading && sessions.length > 0" class="table-responsive">
    <table class="table table-hover table-striped">
      <thead class="table-dark">
        <tr>
          <th>Session ID</th>
          <th>Start Time</th>
          <th>End Time</th>
          <th>Duration</th>
          <th>Version</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let session of sessions">
          <td>
            <small class="text-muted">{{ (session._id || session.id || '').substring(0, 12) }}...</small>
          </td>
          <td>{{ formatDate(session.startTime || session.starttime) }}</td>
          <td>{{ formatDate(session.endTime || session.endtime) }}</td>
          <td>
            <span class="badge bg-info">
              {{ calculateDuration(session.startTime || session.starttime, session.endTime || session.endtime) }}
            </span>
          </td>
          <td>
            <span class="badge bg-success">{{ session.version }}</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Кнопка обновления -->
  <div class="mt-4">
    <button class="btn btn-primary" (click)="loadSessions()">
      <i class="bi bi-arrow-clockwise"></i> Refresh Sessions
    </button>
    <small class="text-muted ms-2">Showing {{ sessions.length }} session(s)</small>
  </div>
</div>